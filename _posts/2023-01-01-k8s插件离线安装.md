---
layout:     post
title:      k8s插件离线安装
subtitle:   k8s插件离线安装
date:       2023-01-01
author:     eddie
header-img: img/home-bg-o.jpg
catalog: true
tags:
    - k8s
---


####
安装插件管理器krew

```
#!/bin/bash

##下载安装包
wget https://github.com/kubernetes-sigs/krew/releases/download/v0.4.4/krew-linux_amd64.tar.gz

##下载krew.yaml文件
wget https://github.com/kubernetes-sigs/krew-index/blob/master/plugins/krew.yaml

###查看krew.yaml  获取krew安装包地址
cat krew.yaml|grep krew-linux_amd64

##解压
tar zxvf krew-linux_amd64.tar.gz

###安装：
./krew-linux_amd64 install --manifest=krew.yaml --archive=krew-linux_amd64.tar.gz

### 加载环境变量 vi ~/.bashrc
export PATH="${KREW_ROOT:-$HOME/.krew}/bin:$PATH"

### 验证
[root@i-u3hl7a5j ~]# kubectl krew  -h
kubectl krew
```

####
插件地址
```
https://krew.sigs.k8s.io/plugins/
```


####
在线安装插件
```
kubectl krew install {插件}
```
####
离线安装插件,yaml文件和tar包要对应
```

1. 查看插件列表 
https://github.com/kubernetes-sigs/krew-index/tree/master/plugins

2.  下载需要插件 ns 的yaml文件
wget https://github.com/kubernetes-sigs/krew-index/blob/master/plugins/ns.yaml

3.  获取 ns 插件所需要软件包
[root@i-u3hl7a5j tmp.KovSCCk8Ma]# cat ns.yaml |grep uri
    uri: https://github.com/ahmetb/kubectx/archive/v0.9.4.tar.gz

4. 下载
wget   https://github.com/ahmetb/kubectx/archive/v0.9.4.tar.gz

5. 安装
kubectl krew install --manifest=ns.yaml --archive=v0.9.4.tar.gz
```

####官方文档

https://krew.sigs.k8s.io/docs/user-guide/setup/install/


####插件使用方法

kubectl get pod mypod -o yaml | kubectl neat

kubectl get pod mypod -oyaml | kubectl neat -o json

kubectl neat -f - <./my-pod.json

kubectl neat -f ./my-pod.json

kubectl neat -f ./my-pod.json --output yaml


