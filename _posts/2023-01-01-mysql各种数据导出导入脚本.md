
####
一。导出mysql的全部库的表结构


```

#!/bin/bash

function dump_ddl(){

    dt=`date +%Y%m%d`
    db_nm=root
    db_port=3306
    db_pwd=Wanzhu@sby!
    db_host=10.17.12.2
    db_dir=/home/eddie
    mkdir -p $db_dir/db_bak; cd $db_dir/db_bak

    echo "show databases"|mysql -u$db_nm -p$db_pwd -h$db_host -P $db_port|egrep -vi "database|bak|information_schema|performance_schema" > /tmp/db-name.info
    if [ $? -eq 0 ]; then
        if [ -f /tmp/db-name.info ]; then
            while read line; do
                mysqldump -u$db_nm -p$db_pwd -h$db_host -P$db_port \
                --single-transaction --default-character-set=utf8 \
                --max_allowed_packet=1073741824 --net_buffer_length=16384 \
                --opt -d $line \
                > $line-$dt.sql

            done < /tmp/db-name.info
        fi
    fi
    }
dump_ddl


```

####
二。导出某个库的多张表数据
```

while read line
do
   mysqldump -u root -p"Wanzhu@sby!" -P 3306 -h 10.17.12.6 {库名} $line>${line}.sql


done<tables.txt   (多张表的文件，一行一个表名)

```


####
三。多张表数据导入到某个库
```
while read line
do
   mysqldump -u root -p"Wanzhu@sby!" -P 3306 -h 10.17.12.6 {库名} $line<${line}.sql


done<tables.txt   (多张表的文件，一行一个表名)

```



####
四。将查询的的结果导出为insert语句
```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Time    : 2024/02/19 11:50
# @Author  : eddie
# @File    : 


import pymysql


host="10.17.12.6"
port=3306
user="root"
password= "Wanzhu@sby!"
database="saas_ability_area"
table_file="tables.txt"


conn=pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    read_timeout=10
)

cursor = conn.cursor()

# 执行查询
with open(table_file) as file:
    for line in file.readlines():
        line=line.strip()
        query = f"SELECT * FROM {line} where project_code in('ZH_00022_XM_00000001','ZH_00022_XM_00000002');"
        cursor.execute(query)

        # 获取表结构信息
        columns = [desc[0] for desc in cursor.description]

        # 构造INSERT语句
        insert_statements = []
        for row in cursor:
            values = ['"%s"' % col.replace('"', '\\"') if isinstance(col, str) else ('NULL' if col is None else str(col)) for col in row]
            statement = f"INSERT INTO {line} ({', '.join(columns)}) VALUES ({', '.join(values)});"
            insert_statements.append(statement)

        # 将INSERT语句写入文件
        with open(f"{line}"+".sql", 'w') as f:
            for stmt in insert_statements:
                f.write(stmt + '\n')

# 关闭连接
cursor.close()
conn.close()
```

