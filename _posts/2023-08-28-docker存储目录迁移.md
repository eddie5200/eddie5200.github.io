---
layout:     post
title:      docker存储目录迁移
subtitle:   docker存储目录迁移
date:       2023-08-28
author:     eddie
header-img: img/home-bg-o.jpg
catalog: true
tags:
    - docker
---
	1. 查看原docker存储目录，一般为/var/lib/docker
		docker info|grep -i dir
		#Docker Root Dir: /var/lib/docker
	2. 停止docker
		systemctl stop docker
	3. 备份docker存储目录 备份到/data/docker
		cp -r   /var/lib/docker  /data/docker
	4. 修改docker的systemd的docker.service的配置文件
		# vim /usr/lib/systemd/system/docker.service
		#ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock (注释原先的)
		ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --graph=/app/docker/data-root（新增的）
	5. 修改/etd/docker/daemon.json新增配置data-root
			{   "exec-opts": ["native.cgroupdriver=systemd"],
			   "data-root": "/app/docker/data-root"
			}

	6. 重载
		 systemctl daemon-reload
		 systemctl restart docker



---